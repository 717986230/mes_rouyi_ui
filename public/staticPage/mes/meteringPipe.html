<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管道进厂计量单视图</title>

    <link rel="stylesheet" href="css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
</head>

<body>
    <div class="container-fluid text-center">
        <div class="row" tag="日期范围选择">
            <div class="col-1 m-2">
                <label>日期：</label>
            </div>
            <div class="col-2 m-2">
                <input type="date" id="dayFrom" date="2023/9/13">
            </div>
            <div class="col-1 m-2">班次：</div>
            <div class="col-3 m-1">
                <select class="form-select" aria-label="default select">
                    <option value="0" selected>夜班|20:00:00-08:00:00</option>
                    <option value="1">白班|08:00:00-20:00:00</option>
                </select>
            </div>
            <div class="col-1 m-2">状态：</div>
            <div class="col-2 m-1">
                <select class="form-select" aria-label="default select">
                    <option value="0" selected>制单状态</option>
                    <option value="1">制单完成</option>
                </select>
            </div>
            <div class="col-1">
                <button type="button" class="btn btn-primary border p-2 text-nowrap">
                    <i class="bi bi-search"></i> 查询</button>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <div class="d-flex m-2">
                    <button type="button" class="btn btn-outline-success text-nowrap text-success border m-2"
                        data-bs-toggle="modal" data-bs-target="#meteringPipeDialog"><i class="bi bi-plus-lg"></i>
                        创建</button>
                    <button type="button" class="btn btn-outline-success text-success border m-2"><i
                            class="bi bi-database-gear"></i> 维护</button>
                    <button type="button" class="btn btn-outline-danger text-danger border m-2"><i
                            class="bi bi-database-fill-x"></i> 关闭</button>
                    <button type="button" class="btn btn-outline-warning text-danger text-nowrap border m-2"><i
                            class="bi bi-trash"></i> 删除</button>
                </div>
            </div>

            <div class="col-1 p-3">
                <button class="btn btn-outline-secondary"
                    style="width: 35px; height: 35px; border-radius: 50%; font-size: 12px;">
                    <i class="bi bi-search"></i>
                </button>
            </div>
        </div>
        <hr>
        <div class="row p-1 border-1" tag="表格表头定义">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th></th>
                        <th>
                            <input type="checkbox">
                        </th>
                        <th>单据编号</th>
                        <th>业务开始班次时间</th>
                        <th>业务结束班次时间</th>
                        <th>进出场点</th>
                        <th>主物料名称</th>
                        <th>单据总量</th>
                        <th>确认总量</th>
                        <th>单据状态</th>
                        <th>物料组分</th>
                        <th>辅计量</th>
                        <th>创建人</th>
                        <th>创建时间</th>
                        <th>关闭人</th>
                        <th>关闭时间</th>
                        <th>备注</th>
                    </tr>
                </thead>
                <tbody id="meteringPointTable">
                </tbody>
            </table>
            <nav aria-label="Page navigation example">
                <ul class="pagination justify-content-end p-2">
                    <label class="p-2">共 5 条</label>
                    <select class="m-2">
                        <option selected>10条/页</option>
                        <option value="1">20条/页</option>
                        <option value="2">30条/页</option>
                        <option value="3">50条/页</option>
                    </select>

                    <li class="page-item disabled">
                        <a class="page-link">
                            < </a>
                    </li>
                    <li class="page-item"><a class="page-link" href="#">1</a></li>
                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                    <li class="page-item">
                        <a class="page-link" href="#"> > </a>
                    </li>

                    <label class="p-2">前往</label>
                    <input class="text-center" type="text" value="1" style="width: 40px;">
                    <label class="p-2">页</label>
                </ul>
            </nav>
        </div>
    </div>


    <div class="modal fade" id="meteringPipeDialog" tabindex="-1" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content" style="text-align: right;">
                <div class="modal-header bg-light">
                    <h5 class="modal-title text-nowrap">计量单创建</h5>
                    <button type="button" class="btn-close form-control" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="border-1 p-2">
                        <div class="row text-right m-2" tag="行1">
                            <div class="col-2 text-right text-nowrap p-2">
                                金出场点：
                            </div>
                            <div class="col">
                                <select class="form-select" aria-label="select">
                                    <option value="0" selected>进厂点-1#罐区</option>
                                    <option value="1">进厂点-2#罐区</option>
                                    <option value="2">出厂点-1#罐区</option>
                                    <option value="3">出厂点-2#罐区</option>
                                </select>
                            </div>
                            <div class="col-2"></div>
                            <div class="col-2 text-right text-nowrap p-2">
                                物料：
                            </div>
                            <div class="col">
                                <select class="form-select" aria-label="select">
                                    <option value="0" selected>原油</option>
                                    <option value="1">92#汽油</option>
                                    <option value="2">柴油</option>
                                    <option value="3">航空煤油</option>
                                </select>
                            </div>
                            <div class="col"></div>
                        </div>
                        <div class="row text-right m-2" tag="行2">
                            <div class="col-2 text-right text-nowrap p-2">
                                开始班次：
                            </div>
                            <div class="col-1">
                                <input type="text" class="form-control-sm" value="2023-09-23 08:00:00">
                            </div>
                            <div class="col"></div>
                            <div class="col-2 text-right text-nowrap p-2">
                                结束班次：
                            </div>
                            <div class="col-1">
                                <input type="text" class="form-control-sm" value="2023-09-23 20:00:00">
                            </div>
                            <div class="col"></div>
                        </div>
                        <div class="row text-right m-2" tag="行3">
                            <div class="col-2 text-right text-nowrap p-2">
                                录入者：
                            </div>
                            <div class="col-1">
                                <input type="text" class="form-control-sm">
                            </div>
                            <div class="col"></div>
                            <div class="col-2 text-right text-nowrap p-2">
                                录入日期：
                            </div>
                            <div class="col-1">
                                <input type="text" class="form-control-sm" value="2023-09-23">
                            </div>
                            <div class="col"></div>
                        </div>
                        <div class="row text-right m-2" tag="行4">
                            <div class="col-2 text-right text-nowrap p-2">
                                关闭者：
                            </div>
                            <div class="col-1">
                                <input type="text" class="form-control-sm">
                            </div>
                            <div class="col"></div>
                            <div class="col-2 text-right text-nowrap p-2">
                                结束时间：
                            </div>
                            <div class="col-1">
                                <input type="text" class="form-control-sm" value="12:00:00">
                            </div>
                            <div class="col"></div>
                        </div>
                        <div class="row text-right m-2" tag="行5">
                            <div class="col-2 text-right text-nowrap p-2">
                                单据总量：
                            </div>
                            <div class="col-1">
                                <input type="text" class="form-control-sm" value="1">
                            </div>
                            <div class="col"></div>
                            <div class="col-2 text-right text-nowrap p-2">
                                确认总量：
                            </div>
                            <div class="col-1">
                                <input type="text" class="form-control-sm" value="0">
                            </div>
                            <div class="col">
                                <button>-></button>
                            </div>
                        </div>
                        <div class="row text-right m-2" tag="行6">
                            <div class="col-2 text-right text-nowrap p-2">
                                单据编号：
                            </div>
                            <div class="col-1">
                                <input type="text" class="form-control-sm">
                            </div>
                            <div class="col"></div>
                            <div class="col-2 text-right text-nowrap p-2">
                                订单编号：
                            </div>
                            <div class="col-1">
                                <input type="text" class="form-control-sm">
                            </div>
                            <div class="col"></div>
                        </div>
                        <div class="row text-right m-2" tag="行7">
                            <div class="col-2 text-right text-nowrap p-2">
                                备注：
                            </div>
                            <div class="col">
                                <input type="text" class="form-control-sm" style="width: 550px; height: 80px;">
                            </div>
                            <div class="col"></div>
                        </div>
                        <div class="row text-right m-2" tag="行8">
                            <div class="col"></div>
                            <div class="col-2 text-nowrap"><button type="button"
                                    class="btn btn-outline-success text-success border m-2"><i
                                        class="bi bi-battery-half"></i> 保存</button></div>
                            <div class="col-2 text-nowrap"><button type="button"
                                    class="btn btn-outline-success text-success border m-2"><i
                                        class="bi bi-battery-full"></i> 完成</button></div>
                            <div class="col"></div>
                        </div>
                        <div class="row text-right m-2" tag="行9 选项卡">
                            <ul class="nav nav-tabs" id="myTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <a class="nav-link active" id="tab1-tab" data-bs-toggle="tab" href="#tab1"
                                        role="tab" aria-controls="tab1" aria-selected="true">计量记录</a>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <a class="nav-link" id="tab2-tab" data-bs-toggle="tab" href="#tab2" role="tab"
                                        aria-controls="tab2" aria-selected="false">物料分组</a>
                                </li>
                            </ul>
                            <div class="tab-content mt-3" id="myTabsContent">
                                <div class="tab-pane fade show active" id="tab1" role="tabpanel"
                                    aria-labelledby="tab1-tab">
                                    <table class="table table-bordered table-striped table-hover">
                                        <thead>
                                            <tr>
                                                <th></th>
                                                <th>表（车、罐）号</th>
                                                <th>计量方式</th>
                                                <th>前读数（空车）</th>
                                                <th>后读数（重车）</th>
                                                <th>计量量</th>
                                                <th>确认量</th>
                                                <th>前量（空车）时间</th>
                                                <th>后量（重车）时间</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>
                                                    <input type="checkbox">
                                                </td>
                                                <td>
                                                    罐#1
                                                </td>
                                                <td>表计量</td>
                                                <td>1234</td>
                                                <td>1235</td>
                                                <td>1235</td>
                                                <td>1235</td>
                                                <td>12:00:08</td>
                                                <td>14:00:12</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="tab-pane fade" id="tab2" role="tabpanel" aria-labelledby="tab2-tab">
                                    <p>物料分组</p>
                                </div>
                            </div>
                        </div>
                        <div class="row text-right m-2" tag="行10 按钮">
                            <div class="col-3"><button
                                    class="btn btn-outline-primary text-primary text-nowarp border m-2"> <i
                                        class="bi bi-calculator"></i> 表计量</button></div>
                            <div class="col-2"><button type="button"
                                    class="btn btn-outline-danger text-danger text-nowrap border m-2"><i
                                        class="bi bi-trash"></i>
                                    删除</button></div>
                            <div class="col-2"><button type="button"
                                    class="btn btn-outline-success text-success border m-2"><i
                                        class="bi bi-database-gear"></i>
                                    维护</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>
    <script src="script/bootstrap.bundle.js"></script>

    <script>
        var jsonData = [
            {
                "id": 1, "col1": "202309212035001", "col2": "2023-09-21 08:00:00", "col3": "2023-09-21 20:00:00", "col4": "管输MTBE进厂点",
                "col5": "甲基叔丁基醚", "col6": "0", "col7": "0", "col8": "制单中", "col9": "", "col10": "", "col11": "付连攀",
                "col12": "2023-09-21 12:35:00", "col13": "", "col14": "", "col15": "", "col16": [
                    {
                        "id": 1, "col1": "联合石化MTBE", "col2": "表计量", "col3": "12816.28", "col4": "0", "col5": "0", "col6": "2023-09-21 08:00:00",
                        "col7": "2023-09-21 12:00:00", "col8": "2023-09-21 08:00:00", "col9": "2023-09-21 20:00:00", "col10": "付连攀",
                        "col11": "2023-09-21 12:35:00", "col12": "付连攀", "col13": "2023-09-21 12:35:00", "col14": "付连攀", "col15": ""
                    }
                ]
            },
            {
                "id": 2, "col1": "202309212035001", "col2": "2023-09-21 08:00:00", "col3": "2023-09-21 20:00:00", "col4": "管输MTBE进厂点",
                "col5": "甲基叔丁基醚", "col6": "0", "col7": "0", "col8": "制单中", "col9": "", "col10": "", "col11": "付连攀",
                "col12": "2023-09-21 12:35:00", "col13": "", "col14": "", "col15": "", "col16": [
                    {
                        "id": 1, "col1": "联合石化MTBE", "col2": "表计量", "col3": "12816.28", "col4": "0", "col5": "0", "col6": "2023-09-21 08:00:00",
                        "col7": "2023-09-21 12:00:00", "col8": "2023-09-21 08:00:00", "col9": "2023-09-21 20:00:00", "col10": "付连攀",
                        "col11": "2023-09-21 12:35:00", "col12": "付连攀", "col13": "2023-09-21 12:35:00", "col14": "付连攀", "col15": ""
                    }
                ]
            },
            {
                "id": 3, "col1": "202309212035001", "col2": "2023-09-21 08:00:00", "col3": "2023-09-21 20:00:00", "col4": "管输MTBE进厂点",
                "col5": "甲基叔丁基醚", "col6": "0", "col7": "0", "col8": "制单中", "col9": "", "col10": "", "col11": "付连攀",
                "col12": "2023-09-21 12:35:00", "col13": "", "col14": "", "col15": "", "col16": [
                    {
                        "id": 1, "col1": "联合石化MTBE", "col2": "表计量", "col3": "12816.28", "col4": "0", "col5": "0", "col6": "2023-09-21 08:00:00",
                        "col7": "2023-09-21 12:00:00", "col8": "2023-09-21 08:00:00", "col9": "2023-09-21 20:00:00", "col10": "付连攀",
                        "col11": "2023-09-21 12:35:00", "col12": "付连攀", "col13": "2023-09-21 12:35:00", "col14": "付连攀", "col15": ""
                    }
                ]
            },
            {
                "id": 4, "col1": "202309212035001", "col2": "2023-09-21 08:00:00", "col3": "2023-09-21 20:00:00", "col4": "管输MTBE进厂点",
                "col5": "甲基叔丁基醚", "col6": "0", "col7": "0", "col8": "制单中", "col9": "", "col10": "", "col11": "付连攀",
                "col12": "2023-09-21 12:35:00", "col13": "", "col14": "", "col15": "", "col16": [
                    {
                        "id": 1, "col1": "联合石化MTBE", "col2": "表计量", "col3": "12816.28", "col4": "0", "col5": "0", "col6": "2023-09-21 08:00:00",
                        "col7": "2023-09-21 12:00:00", "col8": "2023-09-21 08:00:00", "col9": "2023-09-21 20:00:00", "col10": "付连攀",
                        "col11": "2023-09-21 12:35:00", "col12": "付连攀", "col13": "2023-09-21 12:35:00", "col14": "付连攀", "col15": ""
                    }
                ]
            },
            {
                "id": 5, "col1": "202309212035001", "col2": "2023-09-21 08:00:00", "col3": "2023-09-21 20:00:00", "col4": "管输MTBE进厂点",
                "col5": "甲基叔丁基醚", "col6": "0", "col7": "0", "col8": "制单中", "col9": "", "col10": "", "col11": "付连攀",
                "col12": "2023-09-21 12:35:00", "col13": "", "col14": "", "col15": "", "col16": [
                    {
                        "id": 1, "col1": "联合石化MTBE", "col2": "表计量", "col3": "12816.28", "col4": "0", "col5": "0", "col6": "2023-09-21 08:00:00",
                        "col7": "2023-09-21 12:00:00", "col8": "2023-09-21 08:00:00", "col9": "2023-09-21 20:00:00", "col10": "付连攀",
                        "col11": "2023-09-21 12:35:00", "col12": "付连攀", "col13": "2023-09-21 12:35:00", "col14": "付连攀", "col15": ""
                    }
                ]
            }
        ]

        //使用 json数据 动态填充表格
        const tablebody = document.getElementById('meteringPointTable');
        tablebody.innerHTML = ""
        jsonData.forEach(item => {
            row = tablebody.insertRow(tablebody.rows.length);
            cellbtn = row.insertCell(row.length);
            cellbtn.innerHTML = `<button class="btn btn-outline-primary btn-sm" 
                onclick="handleButtonClick(this, ${item.id})">+</button>`;
            cellbtn = row.insertCell(row.length);
            cellbtn.innerHTML = `<input type='checkbox'>`;
            cell1 = row.insertCell(row.length);
            cell1.innerText = item.col1;
            cell2 = row.insertCell(row.length);
            cell2.innerText = item.col2;
            cell3 = row.insertCell(row.length);
            cell3.innerText = item.col3;
            cell4 = row.insertCell(row.length);
            cell4.innerText = item.col4;
            cell5 = row.insertCell(row.length);
            cell5.innerText = item.col5;
            cell6 = row.insertCell(row.length);
            cell6.innerText = item.col6;
            cell7 = row.insertCell(row.length);
            cell7.innerText = item.col7;
            cell8 = row.insertCell(row.length);
            cell8.innerText = item.col8;
            cell9 = row.insertCell(row.length);
            cell9.innerText = item.col9;
            cell10 = row.insertCell(row.length);
            cell10.innerText = item.col10;
            cell11 = row.insertCell(row.length);
            cell11.innerText = item.col11;
            cell12 = row.insertCell(row.length);
            cell12.innerText = item.col12;
            cell13 = row.insertCell(row.length);
            cell13.innerText = item.col13;
            cell14 = row.insertCell(row.length);
            cell14.innerText = item.col14;
            cell15 = row.insertCell(row.length);
            cell15.innerText = item.col15;
            tablebody.appendChild(row);
            // new_row = tablebody.insertRow(tablebody.rows.length);
            // new_row.id = `expend_table_${item.id}`;
            // new_row.style.display = "none";
            tablebody.appendChild(row);
        });

        // 按钮点击处理函数
        function handleButtonClick(button, id) {
            tb_container = document.getElementById(`expend_table_${id}`);
            if (button.innerText == '+') {
                button.innerHTML = '-';

                tb_container.style.display = "";
            }
            else {
                button.innerText = '+';
                tb_container.innerHTML = ``;
                tb_container.style.display = "none";
            }
            item = jsonData.find(item => item.id === id);
            col10 = item.col10;
            if (typeof col10 === 'undefined') {
                return;
            }
            tb_container.innerHTML = ``;
            const border = document.createElement('td');
            border.colSpan = '5';

            const table = document.createElement('table');
            table.className = 'table';

            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            headerRow.innerHTML = `<th></th><th>表（车、罐）号</th><th>计量方式</th><th>前读数（空车）</th><th>后读数（重车）</th>
                <th>0</th><th>0</th><th>2023-09-21 08:00:00</th><th>2023-09-21 12:00:00</th><th>2023-09-21 08:00:00</th><th>2023-09-21 20:00:00</th>
                <th>付连攀</th><th>2023-09-21 08:00:00</th><th>付连攀</th><th>2023-09-21 13:00:00</th><th>付连攀</th>
                `;
            thead.appendChild(headerRow);

            table.appendChild(thead);
            const tbody = document.createElement('tbody');

            for (const rowData of col10) {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${rowData.id}</td><td>${rowData.col1}</td><td>${rowData.col2}</td>
                    <td>${rowData.col3}</td><td>${rowData.col4}</td><td>${rowData.col5}</td><td>${rowData.col6}</td>
                    <td>${rowData.col7}</td><td>${rowData.col8}</td><td>${rowData.col9}</td><td>${rowData.col10}</td>
                    <td>${rowData.col11}</td><td>${rowData.col12}</td><td>${rowData.col13}</td><td>${rowData.col14}</td>
                    <td>${rowData.col15}</td>
                    `;
                tbody.appendChild(row);
            };
            table.appendChild(tbody);
            border.appendChild(table);
            tb_container.appendChild(border);
        }


        const datalen = document.getElementById('data_length');
        datalen.innerText = jsonData.length

    </script>
</body>


</html>